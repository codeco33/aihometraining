<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="aihometraining.team.challenge.mapper.ChallengeEnterMapper">
	<resultMap type="ChallengeEnter" id="challengeEnterResultMap">
		<result column="challengeEnterCode" 				property="challengeEnterCode"/>
		<result column="challengeCategoryCode" 				property="challengeCategoryCode"/>
		<result column="challengeGatherCode" 				property="challengeGatherCode"/>
		<result column="memberEmail" 						property="memberEmail"/>
		<result column="challengeEnterContent" 				property="challengeEnterContent"/>
		<result column="challengeEnterDeposit" 				property="challengeEnterDeposit"/>
		<result column="challengeEnterDate" 				property="challengeEnterDate"/>
		<result column="challengeServiceStartDate" 			property="challengeServiceStartDate"/>
		<result column="challengeServiceEndDate" 			property="challengeServiceEndDate"/>
		
		<association property="challengeCategory" javaType="ChallengeCategory">
			<id 	column="challengeCategoryCode" 			property="challengeCategoryCode"/>
			<result column="memberEmail" 					property="memberEmail"/>
			<result column="challengeCategoryName" 			property="challengeCategoryName"/>
			<result column="challengeCategoryRegDate" 		property="challengeCategoryRegDate"/>
			<result column="eClassCategorySmallCode" 		property="eClassCategorySmallCode"/>
			<result column="memberUpdateEmail"		 		property="memberUpdateEmail"/>
			<result column="memberUpdateDate" 				property="memberUpdateDate"/>
		</association>
		
		<association property="challengeGather" javaType="ChallengeGather">
			<id 	column="challengeGatherCode" property="challengeGatherCode"/>
			<result column="memberEmail" 					property="memberEmail"/>
			<result column="challengeCategoryCode" 			property="challengeCategoryCode"/>
			<result column="challengeGatherName" 			property="challengeGatherName"/>
			<result column="challengeGatherIntro" 			property="challengeGatherIntro"/>
			<result column="challengeGatherMaxPeople" 		property="challengeGatherMaxPeople"/>
			<result column="challengeGatherProveMethod" 	property="challengeGatherProveMethod"/>
			<result column="challengeGatherProveContent" 	property="challengeGatherProveContent"/>
			<result column="challengeGatherProveFrequency" 	property="challengeGatherProveFrequency"/>
			<result column="challengeGatherAchieveRate" 	property="challengeGatherAchieveRate"/>
			<result column="challengeStartDate" 			property="challengeStartDate"/>
			<result column="challengeEndDate" 				property="challengeEndDate"/>
			<result column="challengeGatherRegDate" 		property="challengeGatherRegDate"/>
			<result column="memberEnterEmail" 				property="memberEnterEmail"/>
			<result column="challengeGatherStartDate" 		property="challengeGatherStartDate"/>
			<result column="challengeGatherEndDate" 		property="challengeGatherEndDate"/>
		</association>
		
		<association property="member" javaType="Member">
			<id 	column="memberEmail" 					property="memberEmail"/>
			<result column="memberPw" 						property="memberPw"/>
			<result column="memberLevelCode" 				property="memberLevelCode"/>
			<result column="memberNewsAgree" 				property="memberPw"/>
			<result column="memberNewsAgree" 				property="memberNewsAgree"/>
			<result column="memberRegDate" 					property="memberRegDate"/>
			<result column="memberName" 					property="memberName"/>
			<result column="memberPhone" 					property="memberPhone"/>
			<result column="memberNickname" 				property="memberNickname"/>
			<result column="memberBirthday" 				property="memberBirthday"/>
			<result column="memberGender" 					property="memberGender"/>
			<result column="memberRecommendEmail" 			property="memberRecommendEmail"/>
			<result column="memberFinalPoint" 				property="memberFinalPoint"/>
		</association>
		
	</resultMap>


	<select id="getChallengeEnterListByEmail" parameterType="String"  resultMap="challengeEnterResultMap">
		/* 회원 이메일별 참가 챌린지 목록 조회 */
		SELECT
			ce.challengeEnterCode
			,cc.challengeCategoryCode
			,cc.challengeCategoryName
			,cg.challengeGatherCode
			,cg.challengeGatherName
			,cg.challengeGatherIntro
		FROM
			challengeenter AS ce
			INNER join
			challengecategory AS cc
			on
			ce.challengeCategoryCode = cc.challengeCategoryCode
			INNER join
			challengegather AS cg
			on
			cg.challengeGatherCode = ce.challengeGatherCode
			INNER join
			member AS m
			on
			m.memberEmail = ce.memberEmail
		WHERE
			ce.memberEmail = #{memberEmail}
	</select>
</mapper>